<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>菜鸟教程(runoob.com)</title>
<style>
    .box {
        width: 100%;
        height: 100vh;
        /* background-color: aqua; */
        display: flex;
        flex-flow: row wrap;
    }
    .start {
        align-self: flex-start;
        width: 100%;
        height: 1200px;
        background-color: blue;
    }
    .end {
        align-self: flex-end;
        width: 100%;
        height: 80px;
        background-color: black;
        margin-bottom: 80px;
    }
</style>
</head>
<body>
    <div class="box">
        <div class="start"></div>
        <div class="end"></div>
        <input type="button" value="call native">
    </div>
</body>
<script>

window.hcJsBridge = {
    callHandler: callHandler,
}
var uniqueId = 1;

function callHandler(name, data, responseCallback) {
    if (arguments.length == 2 && typeof data == 'function') {
        responseCallback = data;
        data = null;
    }
    var message = {name:name, data:data};
    if (responseCallback) {
        var callbackId = 'cb_'+(uniqueId++)+'_'+new Date().getTime();
        message["callbackId"] = callbackId;
        hcJsBridge.messageCallbacks[callbackId] = responseCallback;
    }
    var messageJson = JSON.stringify(message);
    if (typeof nativeBridgeHead === "undefined") {
        window.webkit.messageHandlers.handleMessage.postMessage(messageJson);
    } else {
        nativeBridgeHead.handleMessage(messageJson);
    }
}

window.MagicJSBridge = {
    openLogin() {
        try {
            hcJsBridge.callHandler('magicBox.openLogin')
        } catch (r) {
            console.log('请在app上使用', r)
        }
    },
    share(params) {
        try {
            alert('112233')
            hcJsBridge.callHandler('magicBox.share', params)
        } catch (r) {
            console.log('请在app上使用', r)
        }
    },
    getAccessToken() {
        return new Promise((resolve, reject) => {
            hcJsBridge.callHandler('magicBox.getAccessToken', data, function (response) {
                resolve(JSON.parse(response))
            })
        })
    },
    getSchemeAndLink() {
        return new Promise((resolve, reject) => {
            hcJsBridge.callHandler('magicBox.scheme', data, function (response) {
                resolve(JSON.parse(response))
            })
        })
    }
}

const button = document.querySelector("input")
button.addEventListener("click", updateButton);

function updateButton() {
    MagicJSBridge.share()
}
</script>
</html>
